## Продвинутый SQL. Когортный анализ, Retention Rate, LTV, Churn Rate

Расчет параметров выполнен в интерактивном тренажере на платформе Яндекс.Практикума.

ER-диаграмма базы данных:
<img width="934" alt="image" src="https://user-images.githubusercontent.com/112425295/232772775-d413a67f-19a4-4465-bf1c-9d4ea810df0d.png">

Описание данных, которые хранят таблицы:

**Таблица `users`** - Cодержит данные о пользователях.

- `user_id` -	Идентификатор пользователя, первичный ключ таблицы
- `first_name` -		Имя пользователя
- `last_name` -		Фамилия пользователя
- `email` -		Электронный адрес пользователя
- `created_at` -		Дата создания аккаунта пользователя

**Таблица `events`** - Содержит данные о событиях.

- `event_id` -	Идентификатор события, первичный ключ таблицы
- `event_time` -	Дата и время события
- `event_name` -	Название события
- `user_id` -	Идентификатор пользователя, внешний ключ, отсылающий к таблице users
- `platform` -	Тип устройства пользователя
- `referrer` -	Источник события пользователя

Типов событий в поле event_name два: 
- `view_item` - просмотр товара;
- `view_user_profile` - просмотр сохранённых товаров другого пользователя.

Значение в поле referrer показывает, какой источник просматривал пользователь перед тем, как совершилось событие. Источники могут быть внешними:
- `google_search` - поисковая система Google;
- `promo_email_click` - рассылка магазина.

В поле referrer могут быть указаны и источники внутри сайта:
- `item_page` - страница товара;
- `user_wishlist` - страница сохранённых товаров другого пользователя;
- `shopping_cart` - корзина;
- `home` - главная страница магазина.

**Таблица `event_x_event_parameter`** - Содержит детальную информацию о событиях.

- `event_id` -	Идентификатор события, внешний ключ, отсылающий к таблице events
- `parameter_name` -	Параметр детализации
- `parameter_value` -	Значение параметра

Если в поле parameter_name указан item_id, то в parameter_value будет храниться идентификатор товара, который просматривал пользователь. 
Если в поле parameter_name указан viewed_user_id, то в parameter_value будет храниться идентификатор пользователя, чью страницу с сохранёнными товарами смотрел другой пользователь.

**Таблица `orders`** - Содержит детальные данные о заказах пользователей.

- `order_id` -	Идентификатор заказа, первичный ключ таблицы
- `user_id` -	Идентификатор пользователя, оформившего заказ
- `total_amt` -	Общая сумма заказа
- `items_cnt` -	Количество товаров в заказе
- `created_at` -	Дата, когда пользователь оформил заказ, но ещё не оплатил его
- `paid_at` -	Дата оплаты заказа

**Таблица `items`** - Содержит данные о товарах.

- `item_id` -	Идентификатор товара, первичный ключ таблицы
- `category` -	Категория товара
- `item_name` -	Название товара
- `price` -	Стоимость

**Таблица `order_x_item`** - Содержит данные о связи заказа с товарами.

- `order_id` -	Идентификатор заказа, внешний ключ, отсылающий к таблице orders
- `item_id` -	Идентификатор товара, внешний ключ, отсылающий к таблице items

**Таблица `costs`** - Содержит данные о стоимости привлечения пользователей.

- `created_at` -	Дата
- `costs` -	Стоимость привлечения
